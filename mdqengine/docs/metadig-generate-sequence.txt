@startuml images/metadig-generate-sequence.png
  skinparam {
  		sequenceTitleFontColor black
		sequenceTitleFontSize 16
		sequenceTitleFontStyle normal
		sequenceTitleFontName Lucida Bright
	}
	title: Generating MetaDIG Quality Reports

	activate "DataONE Client"
	"DataONE Client" -> Metacat : MN.create()
	deactivate "DataONE Client"
	activate Metacat
	Metacat -> MetaDIG_master: generateQualityReport()
	deactivate Metacat
	activate MetaDIG_master
    MetaDIG_master -> MetaDIG_master: scheduleWorker()
    MetaDIG_master -> "queue: generateQualityReport": MetaDIGTask
	deactivate MetaDIG_master
    activate "queue: generateQualityReport" 
    "queue: generateQualityReport" ->> MetaDIG_worker: handleRequest() 
    deactivate "queue: generateQualityReport"
    activate MetaDIG_worker
    MetaDIG_worker -> MetaDIG_quality_engine: runSuite()
    MetaDIG_quality_engine --> MetaDIG_worker: run result
    MetaDIG_worker -> "queue: reportCompleted": worker task result
    deactivate MetaDIG_worker
    activate "queue: reportCompleted"
    "queue: reportCompleted" ->> MetaDIG_master: processReport()
    deactivate "queue: reportCompleted"
    activate MetaDIG_master
    MetaDIG_master -> Metacat: MetacatSolrIndex.submit()
    deactivate MetaDIG_master
  @enduml  
